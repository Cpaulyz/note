# 网络协议

凡是涉及两个或多个远程通信实体的所有活动都受协议的制约

# 网络边缘

## 接入网

将端系统连接到其**边缘路由器**的物理链路

# 网络核心

## 分组交换

**分组**：源将长报文划分为比较小的数据块

源和目的之间，每个分组通过通信链路和**分组交换机**（包括**路由器**和**链路层交换机**）传送

1. **存储转发传输**

	存储转发机制是交换机完整收到一个分组后才进行传输。

	![1587817765154](https://img2020.cnblogs.com/blog/1958143/202004/1958143-20200429120457805-915582801.png)

	时延为2L/R

	如果不用存储转发，时延为L/R

	如果有三个分组，时延为4L/R

	如果一个分组，N-1个路由器，时延NL/R

2. **排队时延和分组丢失**

	分组交换机有**输出缓存**

	**排队时延**：分组传输到某条链路，但是链路正忙，于是到达分组要在输出缓存中等待

	**分组丢失**：排队太长了，超出了缓存容量

	比如路由器左边10Mbps，右边1.5Mbps，就会发生这种情况

	![1587818066807](https://img2020.cnblogs.com/blog/1958143/202004/1958143-20200429120457416-1703357586.png)

3. **转发表和路由选择协议**

## 电路交换

端系统间会话，预留了端系统间通信沿路径所需要的资源（缓存、链路传输速率等）

例如如下，如果两台邻近交换机之间为1Mbps，每个端到端电路交换连接获得250kbps

![1587818422207](https://img2020.cnblogs.com/blog/1958143/202004/1958143-20200429120456998-270265942.png)

1. **频分复用、时分复用**

	frequency-division multiplexing FDM

	time-division multiplexing TDM

	![1587818706506](https://img2020.cnblogs.com/blog/1958143/202004/1958143-20200429120456492-1960138981.png)

	> 24时隙TMD，1.536Mbps，创建端到端电路500ms，问传输640kb？
	>
	> 1.536Mbps/24 = 64kbps
	>
	> 640kbps/64kbps= 10s
	>
	> 10s+500ms = 10.5s

2. **分组交换和电路交换对比**

	* 分组交换不适合实时服务，时延不可测
	* 分组交换更好地带宽共享
	* 分组交换简单、高效、成本低

	> 两个例子
	>
	> ![1587820080037](https://img2020.cnblogs.com/blog/1958143/202004/1958143-20200429120455937-2088815649.png)
	>
	> ![1587820089528](https://img2020.cnblogs.com/blog/1958143/202004/1958143-20200429120455251-1959248436.png)

# 分组交换的时延

## 结点时延

**结点总时延**由以下组成：

d<sub>nodal</sub>=  d<sub>proc</sub>+d<sub>queue</sub>+d<sub>trans</sub>+d<sub>prop</sub>

1. **结点处理时延nodal processing delay**
2. **排队时延queuing delay**
3. **传输时延transmission delay**
4. **传播时延propagation delay**

![1587820700270](https://img2020.cnblogs.com/blog/1958143/202004/1958143-20200429120454630-293041463.png)

**传输时延**是路由器将分组推出所需要的时间，是分组长度和传输速率的函数

**传播时延**是一个比特从一台路由器到另一台路由器传播所需要的时间，是路由器之间距离的函数，与分组长度或链路传输速率无关。

> ![1587820791262](https://img2020.cnblogs.com/blog/1958143/202004/1958143-20200429120454171-1453685596.png)
>
> ![1587820799722](https://img2020.cnblogs.com/blog/1958143/202004/1958143-20200429120453633-549644312.png)

## 端到端时延

假设网络无拥塞，排队时延微不足道

源主机和目的主机间有N-1个路由器

d<sub>end-end</sub>=  N（d<sub>proc</sub>+d<sub>trans</sub>+d<sub>prop</sub>）

# 吞吐量

考虑瓶颈

![1587821506860](https://img2020.cnblogs.com/blog/1958143/202004/1958143-20200429120453199-1694635240.png)

吞吐量为min{R1，R2，...，Rn}

下载F比特的文件需要F/min{R1，R2，...，Rn}

![1587821545760](https://img2020.cnblogs.com/blog/1958143/202004/1958143-20200429120452811-43603504.png)

吞吐量为min{Rs，Rc，R/10}

# 分层

![1587821755854](https://img2020.cnblogs.com/blog/1958143/202004/1958143-20200429120452096-1092660883.png)

* **应用层** 报文message

* **传输层** 报文段segment

* **网络层** 数据包datagram

* **链路层** 帧frame

* **物理层**

	

